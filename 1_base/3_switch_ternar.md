# Тема: Конструкция `Switch` и тернарный оператор `? :`.

Тайминг: 1 час 30 минут (90 минут)

## Дорожная карта занятия

* [Конструкция `Switch`](#switch)
    * [Синтаксис](#switch_syntax)
    * [Группировка](#switch_group)
    * [Кейс по умолчанию](#switch_default)
    * [Когда применять `switch`, а когда `if`?](#compare_switch_if)
* [Тернарный оператор `? :`](#ternar)
* [Итого](#result)
* [Тренировка](#trains)
* [Домашнее задание](#homework)

## <a id="switch">Конструкция `Switch`</a>

Конструкция `switch` - это альтернатива условий `if`.
Данная конструкция позволяет перечислить возможные значения для конкретного условия и обрабатывать эти значения более
емко, чем при использовании `if`.

### <a id="switch_syntax">Синтаксис</a>

Синтаксис данной конструкции достаточно прост и должен иметь обязательно хотя бы один `case` и необязательно `default`.

```javascript
/**
 * @name STATUS_CODE
 * @type {"SYSTEM_ERROR" | "BAD_REQUEST" | "ERR_FORBIDDEN" | any}
 */
const STATUS_CODE = "SYSTEM_ERROR"

switch (STATUS_CODE) {
    case "SYSTEM_ERROR": {
        console.log('Произошла ошибка на сервере...')
        break;
    }
    case "BAD_REQUEST": {
        console.log('Входные данные не валидны')
        break;
    }
    case "ERR_FORBIDDEN": {
        console.log('Доступ запрещен')
        break;
    }
    default: {
        console.log('Обработка по умолчанию...')
        break;
    }
}
```

В данном примере в качестве проверяемого значения мы передаем переменную `STATUS_CODE` в круглые скобки
конструкции `switch`.
Перечисления `case`, находящиеся внутри блока `switch`, будут проверять содержимое `STATUS_CODE` с значением, указанным
возле текущего `case`.

#### Как это работает?

- Переменная `STATUS_CODE` проверяется на строгое равенство первому значению `SYSTEM_ERROR`, затем второму `BAD_REQUEST`
  и так далее.
- Если соответствие установлено – `switch` начинает выполняться от соответствующей директивы `case` и далее, до
  ближайшего `break` (или до конца `switch`).
- Если ни один `case` не совпал – выполняется (если есть) вариант `default`.
- `default` - это тот же `case`, только сработает он в том случае, если ни один `case` выше не отработает, либо
  отработанные выше `case` не вызовут `break` или `return` (поговорим о `return` позже
  в [функциях](https://github.com/Mistrade/mistrade_basic_js_course/blob/main/2_functions/functions.md)).

Ключевое слово `break` останавливает сопоставление `switch` и проверка далее не производится.

Если `break` нет, то выполнение пойдёт ниже по следующим `case`, при этом предыдущие проверки игнорируются.

Это аналогично записям:

```javascript
/**
 * @name STATUS_CODE
 * @type {"SYSTEM_ERROR" | "BAD_REQUEST" | "ERR_FORBIDDEN" | any}
 */
const STATUS_CODE = "SYSTEM_ERROR"

if (STATUS_CODE === 'SYSTEM_ERROR') {
    console.log('Произошла ошибка на сервере...')
} else if (STATUS_CODE === 'BAD_REQUEST') {
    console.log('Входные данные не валидны')
} else if (STATUS_CODE === 'ERR_FORBIDDEN') {
    console.log('Доступ запрещен')
} else {
    console.log('Обработка по умолчанию...')
}
```

> #### Обратите внимание!
>
> В примерах с использованием `if`, мы указали строгое равенство `===` во всех условиях.
> Конструкция `switch` работает точно так же, любое значение `case` должно быть строго равно `===` значению
> переменной `STATUS_CODE`, чтобы блок кода `case` отработал и код выполнился.
>
> Поэтому, стоит запомнить, что для `switch`, тип данных имеет значение, соответственно `0` и `"0"` - это разные типы
> данных, результат сравнения будет `false`, блок `case` не выполнится.

### <a id="switch_group">Группировка</a>

Директивы `case` внутри конструкции `switch` можно группировать. К примеру, нам нужно выполнить одну и ту же логику для
нескольких значений, чтобы не дублировать код, мы можем сгруппировать их:

```javascript
const a = 3

switch (a) {
    case 1: {
        console.log(1)
        break;
    }
    case 3:
    case 5: {
        console.log('Отработал сгруппированный case на 3 и 5');
    }
}
```

В данном примере, мы не указываем блок-обработчик для значения 3, указав лишь `:`, а затем для `case 5` - прописываем
логику.
> #### Важно!
> Чтобы сгруппировать элементы, нужно указывать их друг за другом, и, только для последнего назначить обработчик.

Еще один пример:

```javascript
const a = 12;

switch (a) {
    case 1: {
        console.log('1');
        break;
    }
    case 12:
    case 15:
    case 19:
    case 29: {
        console.log('12 / 15 / 19 / 29')
        break;
    }
    case 35: {
        console.log('35')
    }
    case 39:
    case 45:
    case 198: {
        console.log('39 / 45 / 198')
    }
}
```

### <a id="compare_switch_if">Когда применять `switch`, а когда `if`?</a>

Конструкция `switch` наиболее удобна, когда мы заранее знаем возможные значения переменной и взависимости от этих
значений, нам нужно выполнять разную логику без дополнительных вычислений в момент проверки значения.
В остальных ситуациях, я, рекомендую использовать `if`.

## <a id="ternar">Тернарный оператор `? :`</a>

Ранее, мы рассматривали варианты, когда использовав операторы `||` или `??` мы могли присвоить значение в переменную по
умолчанию в зависимости от значений в другой переменной.
Выглядело это примерно так:

```javascript
const a = "";
const b = a || 'Не определено' // "Не определено"
const c = a ?? 'Не определено' // ""
```

Но, что делать, если нам нужно написать кастомную логику проверок для присвоения значения переменной?
На ум приходит - использовать условия `if`.

```javascript
const a = "";
let b;
let c;

if (!a) {
    b = 'Не определено' //Аналог ||
}

if (a === null || a === undefined) {
    c = 'Не определено' // Аналог ??
}
```

Выглядит достаточно громоздко, поэтому на помощь к нам приходит - тернарный оператор `? :`.

```javascript
const a = "";
const b = !a ? "Не определено" : a // Аналог ||
const c = a === null || a === undefined ? 'Не определено' : a // Аналог ??
```

Конструкция тернарного оператора выглядит следующим образом:

`условие` ? `значение, если условие вернуло true` : `значение, если условие вернуло false`

При этом тернарный оператор поддерживает вложенность тернарных операторов внутри себя, но делать так не стоит, потому
что такой код становится не читабельным. В таких случаях лучше использовать `if`/`switch`.

## <a id="result">Итого</a>

- [Конструкция `switch`](#switch) позволяет перебирать возможные значения переменной и выполнять ту или иную логику в
  зависимости
  от значения переменной, либо выполнить кейс по умолчанию `default`.
- В конструкции `switch` есть возможность [группировки](#switch_group) `case`.
- Узнали, в [каких случаях](#compare_switch_if) лучше использовать `switch`, а когда `if`.
- Существует сокращенная версия `if else` - [тернарный оператор `? :`](#ternar).
- Тернарный оператор хорош, когда нам нужно "на месте" проверить условие и в зависимости от результатов условия вернуть
  какое-либо значение.

## <a id="trains">Тренировка</a>

- Расскажите формулу тернарного оператора.
- Напишите реализацию работы оператора `||` используя тернарный оператор.
- Напишите реализацию работы оператора `??` используя тернарный оператор.
- В каких случаях лучше использовать `switch`, вместо `if`?
- Как конструкция `switch` сравнивает значения?
- Перепишите код, используя `switch`:
  ```javascript
  const a = 22;
  
  if(a === 10){
    console.log('a === 10')
  } else if (a === 12 || a === 15 || a === 19){
    console.log('a === 12 || a === 15 || a === 19')
  } else {
    console.log('default case')
  }
  ```
- Перепишите код, используя тернарный оператор, а вместо `let` используйте `const` для переменной `result`:
  ```javascript
  const a = 1;
  const b = 12;
  let result;

  if (a + b < 4) {
  result = 'Мало';
  } else {
  result = 'Много';
  }
  ```

## <a id="homework">Домашнее задание</a>

1. Исправьте код так, чтобы выполнился только 1 из всех перечисленных `case`, а так
   же `console.log("Сообщение по умолчанию")` вне зависимости от того, какой из `case`
   отработал. Исправлять условия `case`, такие как `2 + 2`, `1 + 3`, `0 + 4` - запрещено:
    ```javascript
    const num = 4;
    
    switch(num){
      case 2 + 2: {
          console.log('2 + 2')
      }
      case 1 + 3: {
          console.log('1 + 3')
      } 
      case 0 + 4: {
          console.log('0 + 4')
      }
    }
    ```

2. Реализуйте конструкцию `switch` следующим образом.
   Есть переменная `ERROR_CODE`, в ней могут храниться следующие
   значения: `"SERVER_ERROR"` | `"SERVICE_UNAVAILABLE"` | `"BAD_GATEWAY"` | `"FORBIDDEN"` | `"BAD_REQUEST"` | `"NOT_FOUND"` | `"CREATED"` | `"OK"`.
   Если переменная содержит одно из значений `"SERVER_ERROR"` | `"SERVICE_UNAVAILABLE"` | `"BAD_GATEWAY"` - то вывести
   сообщение в консоль "Произошла ошибка на сервере", если переменная содержит `"BAD_REQUEST"` - вывести в консоль
   сообщение "Невалидный запрос к серверу", если `"NOT_FOUND"` - "содержимое не найдено", если `"CREATED"` | `"OK"` - "
   Запрос выполнен успешно", во всех остальных случаях: "Непредвиденный ответ сервера".

    ```javascript
    /** 
    * Возможные значения:
    * @type {"SERVER_ERROR" | "SERVICE_UNAVAILABLE" | "BAD_GATEWAY" | "FORBIDDEN" | "BAD_REQUEST" | "NOT_FOUND" | "CREATED" | "OK" | string}
    */
    const ERROR_CODE = "SERVER_ERROR"
    
    switch (ERROR_CODE) {
      //ваш код
    }
    ```

3. Реализуйте задачу номер 3 с правами доступа из
   темы [Вводное занятие](https://github.com/Mistrade/mistrade_basic_js_course/blob/main/1_into/1_what_is_js.md#homework)
   с помощью конструкции `switch`.
4. Перепишите код, используя тернарный оператор вместо `if`, избавьтесь от `let` и используйте `const`:
   ```javascript
   const userAge = 17
   
   let message;
   
   if(userAge >= 18){
    message = 'Пользователь совершеннолетний';
   } else {
    message = 'Пользователь НЕ совершеннолетний';
   }
   ```
5. Попробуйте написать реализацию операторов `!` и `!!`, используя тернарный оператор. Запрещено использовать `!`
   и `!!`, так как нам нужно реализовать их логику:
    ```javascript
    const value = 22;
    const reverseBooleanValue = undefined /* Ваш код тут для реализации !, вместо undefined*/
    const booleanValue = undefined /* Ваш код тут для реализации !!, вместо undefined */ 
    ```
   Вспомнить про операторы `!` и `!!`
   можно [тут](https://github.com/Mistrade/mistrade_basic_js_course/blob/operators/1_base/2_operators.md#negation_operator)

**Подсказка**: весь необходимый объем информации для решения этих задач, есть в текущей статье.

Код задания прислать в `.zip` архиве в [telegram](https://telegram.me/andreimistrade)
